## Event cluster detection

A series of R-scripts were written to first parse and filter the VCF files for events. The filtered events were then check for overlaps and clusters of mutually overlapping groups were output. For the events called by the Delly2 algorithm the overlaps were computed in two ways. Method 1 looked at the actual genomic range and two events were defined to overlap if either the length of both was less than 100,000 bp or the percent overlap was greater than 0.1% where the percent overlap was computed as the length of the overlap divided by the average size of the two events. Method 2 looked at overlap between the _ends_ (or edges) of the events. The ends were defined as region of 701 bp centered on each end of the event. It was these edge regions that were then intersected for overlaps this time using the rule that the percent overlap was greater than 1%.

Once all overlapping events were identified clusters were determined by looking for groups of events that all overlapped with each other. That is each element in the cluster had to overlap with every other element. This is what is known as a maximal clique in graph theory, and we used the R package _igraph_ to both construct the overlap graph and find all maximal cliques in the graph. We then filtered for sets with 3 or more events and output the table of clusters. To examine how the clusters varied on the filtering parameters this entire procedure was repeat multiple times each time adjusting one the following parameters: normalized total read counts (RC/EventSize), high-quality variant junction reads (RV), variant allele frequency (RV/[RR+RV], where RR is the high-quality reference junction reads).

For SNV and small insertion/deletion called by Mutect2 a similar procedure with overlaps being replaced by looking for the precise same event in multiple samples. Filtering was done on the following variables: on allele depth, variant allele frequency and total depth. Since Mutect2 does not report total depth per sample we computed an estimate of total depth by taking the maximum value of the following three estimates: RD/(1-AF), AD/AF and AD+RD, where RD is the depth of the reference reads, AD is the depth of the alternate reads and AF was Mutect2's reported allele frequency. We also computed a consisted variant allele frequency of AD/(AD+RD).
